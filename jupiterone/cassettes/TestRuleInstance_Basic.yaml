---
version: 1
interactions:
- request:
    body: |
      {"query":"\n\t\t\tmutation CreateQuestionRuleInstance ($instance: CreateInlineQuestionRuleInstanceInput!) {\n\t\t\t\tcreateQuestionRuleInstance: createInlineQuestionRuleInstance (\n\t\t\t\t\tinstance: $instance\n\t\t\t\t) {\n\t\t\t\t\tid\n\t\t\t\t\tname\n\t\t\t\t\tdescription\n\t\t\t\t\tversion\n\t\t\t\t\tspecVersion\n\t\t\t\t\tlatest\n\t\t\t\t\tdeleted\n\t\t\t\t\taccountId\n\t\t\t\t\ttype\n\t\t\t\t\tpollingInterval\n\t\t\t\t\ttemplates\n\t\t\t\t\tquestion {\n\t\t\t\t\t\tqueries {\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\tquery\n\t\t\t\t\t\t\tversion\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\toperations {\n\t\t\t\t\t\twhen\n\t\t\t\t\t\tactions\n\t\t\t\t\t}\n\t\t\t\t\toutputs\n\t\t\t\t\ttags\n\t\t\t\t}\n\t\t\t}\n\t\t","variables":{"instance":{"name":"tf-acc-test-5278254352274409628","description":"Test","specVersion":1,"pollingInterval":"ONE_WEEK","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":{"condition":"{{queries.query0.total != 0}}","specVersion":1,"type":"FILTER"},"actions":[{"targetProperty":"alertLevel","targetValue":"HIGH","type":"SET_PROPERTY"},{"type":"CREATE_ALERT"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"createQuestionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":1,"specVersion":1,"latest":true,"deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","pollingInterval":"ONE_WEEK","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":{"condition":"{{queries.query0.total != 0}}","specVersion":1,"type":"FILTER"},"actions":[{"targetProperty":"alertLevel","targetValue":"HIGH","type":"SET_PROPERTY","id":"3fb15a9d-9fe4-4d85-a670-6587cbb76f7c"},{"type":"CREATE_ALERT","id":"4901c436-54e4-4dcd-9c28-b95a81db8406"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "878"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tquery GetQuestionRuleInstance($id: ID!) {\n\t\t\tquestionRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tversion\n\t\t\t\tspecVersion\n\t\t\t\tlatest\n\t\t\t\tpollingInterval\n\t\t\t\tdeleted\n\t\t\t\taccountId\n\t\t\t\ttype\n\t\t\t\ttemplates\n\t\t\t\tquestion {\n\t\t\t\t\tqueries {\n\t\t\t\t\t\tname\n\t\t\t\t\t\tquery\n\t\t\t\t\t\tversion\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperations {\n\t\t\t\t\twhen\n\t\t\t\t\tactions\n\t\t\t\t}\n\t\t\t\toutputs\n\t\t\t\ttags\n\t\t\t}\n\t\t}\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"questionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":1,"specVersion":1,"latest":true,"pollingInterval":"ONE_WEEK","deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":{"type":"FILTER","condition":"{{queries.query0.total != 0}}","specVersion":1},"actions":[{"targetValue":"HIGH","id":"3fb15a9d-9fe4-4d85-a670-6587cbb76f7c","type":"SET_PROPERTY","targetProperty":"alertLevel"},{"type":"CREATE_ALERT","id":"4901c436-54e4-4dcd-9c28-b95a81db8406"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "872"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tquery GetQuestionRuleInstance($id: ID!) {\n\t\t\tquestionRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tversion\n\t\t\t\tspecVersion\n\t\t\t\tlatest\n\t\t\t\tpollingInterval\n\t\t\t\tdeleted\n\t\t\t\taccountId\n\t\t\t\ttype\n\t\t\t\ttemplates\n\t\t\t\tquestion {\n\t\t\t\t\tqueries {\n\t\t\t\t\t\tname\n\t\t\t\t\t\tquery\n\t\t\t\t\t\tversion\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperations {\n\t\t\t\t\twhen\n\t\t\t\t\tactions\n\t\t\t\t}\n\t\t\t\toutputs\n\t\t\t\ttags\n\t\t\t}\n\t\t}\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"questionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":1,"specVersion":1,"latest":true,"pollingInterval":"ONE_WEEK","deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":{"type":"FILTER","condition":"{{queries.query0.total != 0}}","specVersion":1},"actions":[{"targetValue":"HIGH","id":"3fb15a9d-9fe4-4d85-a670-6587cbb76f7c","type":"SET_PROPERTY","targetProperty":"alertLevel"},{"type":"CREATE_ALERT","id":"4901c436-54e4-4dcd-9c28-b95a81db8406"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "872"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tquery GetQuestionRuleInstance($id: ID!) {\n\t\t\tquestionRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tversion\n\t\t\t\tspecVersion\n\t\t\t\tlatest\n\t\t\t\tpollingInterval\n\t\t\t\tdeleted\n\t\t\t\taccountId\n\t\t\t\ttype\n\t\t\t\ttemplates\n\t\t\t\tquestion {\n\t\t\t\t\tqueries {\n\t\t\t\t\t\tname\n\t\t\t\t\t\tquery\n\t\t\t\t\t\tversion\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperations {\n\t\t\t\t\twhen\n\t\t\t\t\tactions\n\t\t\t\t}\n\t\t\t\toutputs\n\t\t\t\ttags\n\t\t\t}\n\t\t}\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"questionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":1,"specVersion":1,"latest":true,"pollingInterval":"ONE_WEEK","deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":{"type":"FILTER","condition":"{{queries.query0.total != 0}}","specVersion":1},"actions":[{"targetValue":"HIGH","id":"3fb15a9d-9fe4-4d85-a670-6587cbb76f7c","type":"SET_PROPERTY","targetProperty":"alertLevel"},{"type":"CREATE_ALERT","id":"4901c436-54e4-4dcd-9c28-b95a81db8406"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "872"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tmutation UpdateQuestionRuleInstance ($instance: UpdateInlineQuestionRuleInstanceInput!) {\n\t\t\t\tupdateQuestionRuleInstance: updateInlineQuestionRuleInstance (\n\t\t\t\t\tinstance: $instance\n\t\t\t\t) {\n\t\t\t\t\tid\n\t\t\t\t\tname\n\t\t\t\t\tdescription\n\t\t\t\t\tversion\n\t\t\t\t\tspecVersion\n\t\t\t\t\tlatest\n\t\t\t\t\tdeleted\n\t\t\t\t\taccountId\n\t\t\t\t\ttype\n\t\t\t\t\tpollingInterval\n\t\t\t\t\ttemplates\n\t\t\t\t\tquestion {\n\t\t\t\t\t\tqueries {\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\tquery\n\t\t\t\t\t\t\tversion\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\toperations {\n\t\t\t\t\t\twhen\n\t\t\t\t\t\tactions\n\t\t\t\t\t}\n\t\t\t\t\toutputs\n\t\t\t\t\ttags\n\t\t\t\t}\n\t\t\t}","variables":{"instance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":1,"specVersion":1,"pollingInterval":"ONE_WEEK","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"actions":[{"targetProperty":"alertLevel","targetValue":"HIGH","type":"SET_PROPERTY"},{"type":"CREATE_ALERT"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"updateQuestionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":2,"specVersion":1,"latest":true,"deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","pollingInterval":"ONE_WEEK","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":null,"actions":[{"targetProperty":"alertLevel","targetValue":"HIGH","type":"SET_PROPERTY","id":"95c30b9c-0cf9-4d3e-8399-84cd4c780257"},{"type":"CREATE_ALERT","id":"70ae6f5c-00c9-47be-b85b-9a80870ed02a"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "805"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tquery GetQuestionRuleInstance($id: ID!) {\n\t\t\tquestionRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tversion\n\t\t\t\tspecVersion\n\t\t\t\tlatest\n\t\t\t\tpollingInterval\n\t\t\t\tdeleted\n\t\t\t\taccountId\n\t\t\t\ttype\n\t\t\t\ttemplates\n\t\t\t\tquestion {\n\t\t\t\t\tqueries {\n\t\t\t\t\t\tname\n\t\t\t\t\t\tquery\n\t\t\t\t\t\tversion\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperations {\n\t\t\t\t\twhen\n\t\t\t\t\tactions\n\t\t\t\t}\n\t\t\t\toutputs\n\t\t\t\ttags\n\t\t\t}\n\t\t}\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"questionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":2,"specVersion":1,"latest":true,"pollingInterval":"ONE_WEEK","deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":null,"actions":[{"targetValue":"HIGH","id":"95c30b9c-0cf9-4d3e-8399-84cd4c780257","type":"SET_PROPERTY","targetProperty":"alertLevel"},{"type":"CREATE_ALERT","id":"70ae6f5c-00c9-47be-b85b-9a80870ed02a"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "799"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tquery GetQuestionRuleInstance($id: ID!) {\n\t\t\tquestionRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tversion\n\t\t\t\tspecVersion\n\t\t\t\tlatest\n\t\t\t\tpollingInterval\n\t\t\t\tdeleted\n\t\t\t\taccountId\n\t\t\t\ttype\n\t\t\t\ttemplates\n\t\t\t\tquestion {\n\t\t\t\t\tqueries {\n\t\t\t\t\t\tname\n\t\t\t\t\t\tquery\n\t\t\t\t\t\tversion\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperations {\n\t\t\t\t\twhen\n\t\t\t\t\tactions\n\t\t\t\t}\n\t\t\t\toutputs\n\t\t\t\ttags\n\t\t\t}\n\t\t}\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"questionRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362","name":"tf-acc-test-5278254352274409628","description":"Test","version":2,"specVersion":1,"latest":true,"pollingInterval":"ONE_WEEK","deleted":false,"accountId":"1316127e-baf6-4c4a-bc01-4fbe9ddd3415","type":"QUESTION","templates":null,"question":{"queries":[{"name":"query0","query":"Find DataStore with classification=('critical' or 'sensitive' or 'confidential' or 'restricted') and encrypted!=true","version":"v1"}]},"operations":[{"when":null,"actions":[{"targetValue":"HIGH","id":"95c30b9c-0cf9-4d3e-8399-84cd4c780257","type":"SET_PROPERTY","targetProperty":"alertLevel"},{"type":"CREATE_ALERT","id":"70ae6f5c-00c9-47be-b85b-9a80870ed02a"}]}],"outputs":["queries.query0.total","alertLevel"],"tags":["tag1","tag2"]}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "799"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tmutation DeleteRuleInstance ($id: ID!) {\n\t\t\tdeleteRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t}\n\t      }\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"data":{"deleteRuleInstance":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "78"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"query":"\n\t\tquery GetQuestionRuleInstance($id: ID!) {\n\t\t\tquestionRuleInstance (id: $id) {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tversion\n\t\t\t\tspecVersion\n\t\t\t\tlatest\n\t\t\t\tpollingInterval\n\t\t\t\tdeleted\n\t\t\t\taccountId\n\t\t\t\ttype\n\t\t\t\ttemplates\n\t\t\t\tquestion {\n\t\t\t\t\tqueries {\n\t\t\t\t\t\tname\n\t\t\t\t\t\tquery\n\t\t\t\t\t\tversion\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperations {\n\t\t\t\t\twhen\n\t\t\t\t\tactions\n\t\t\t\t}\n\t\t\t\toutputs\n\t\t\t\ttags\n\t\t\t}\n\t\t}\n\t","variables":{"id":"7060d853-bc73-4865-90a1-adab066f8362"}}
    form: {}
    headers:
      Accept:
      - application/json; charset=utf-8
      Cache-Control:
      - no-cache
      Content-Type:
      - application/json; charset=utf-8
    url: https://api.us.jupiterone.io/graphql
    method: POST
  response:
    body: |
      {"errors":[{"message":"Could not fetch rule instance. Rule instance does not exist.","extensions":{"code":"INTERNAL_SERVER_ERROR","serviceName":"rules","exception":{"stacktrace":["Error: Could not fetch rule instance. Rule instance does not exist.","    at getQuestionRuleInstance (/var/task/index.js:1069318:13)","    at runMicrotasks (<anonymous>)","    at processTicksAndRejections (internal/process/task_queues.js:95:5)"],"message":"Could not fetch rule instance. Rule instance does not exist.","locations":[{"line":1,"column":50}],"path":["questionRuleInstance"]}}}],"data":{"questionRuleInstance":null}}
    headers:
      Access-Control-Allow-Credentials:
      - "true"
      Content-Length:
      - "610"
      Content-Security-Policy:
      - 'default-src ''self'';base-uri ''self'';block-all-mixed-content;font-src ''self''
        https: data:;form-action ''self'';frame-ancestors ''self'';img-src ''self''
        data:;object-src ''none'';script-src ''self'';script-src-attr ''none'';style-src
        ''self'' https: ''unsafe-inline'';upgrade-insecure-requests'
      Content-Type:
      - application/json
      Cross-Origin-Embedder-Policy:
      - require-corp
      Cross-Origin-Opener-Policy:
      - same-origin
      Cross-Origin-Resource-Policy:
      - same-origin
      Expect-Ct:
      - max-age=0
      Origin-Agent-Cluster:
      - ?1
      Ratelimit-Limit:
      - "1000"
      Ratelimit-Remaining:
      - "999"
      Ratelimit-Requested:
      - "1"
      Ratelimit-Reset:
      - "1"
      Referrer-Policy:
      - no-referrer
      Strict-Transport-Security:
      - max-age=15552000; includeSubDomains
      Vary:
      - Origin
      X-Content-Type-Options:
      - nosniff
      X-Dns-Prefetch-Control:
      - "off"
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - SAMEORIGIN
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
